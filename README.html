<!DOCTYPE html>
<html>
  <head>
    <title>README</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />

    <script type="text/javascript" charset="utf-8">
      relpath = '';
      if (relpath != '') relpath += '/';
    </script>

    <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>
    <script type="text/javascript" charset="utf-8" src="js/app.js"></script>
  </head>

  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>

    <div id="content">
      <h1>elixir-bson</h1>

<p>BSON implementation for Elixir Language</p>

<p>BSON is a binary format in which zero or more key/value pairs are stored as a single entity, called a document. It is a data type with a standard binary representation defined at <a href="http://www.bsonspec.org">http://www.bsonspec.org</a>.</p>

<p>This implements version 1.0 of that spec.</p>

<p>This project is used by <a href="https://github.com/checkiz/elixir-mongo">elixir-mongo</a>, a <a href="http://www.mongodb.org">MongoDB</a> driver in Elixir.</p>

<p>This implementation maps the Bson grammar with Elixir terms in the following way:
  - document: Keyword List
  - int32 and int64: Integer
  - double: Float
  - string: String
  - Array: List (non-keyword)
  - binary: Bson.Bin (record)
  - ObjectId: Bson.ObjectId (record)
  - Boolean: true or false (Atom)
  - UTC datetime: triple Atom
  - Null value: nil (Atom)
  - Regular expression: Bson.Regex (record)
  - JavaScript: Bson.JS (record)
  - Timestamp: Bson.Timestamp (record)
  - Min and Max key: <code>MIN_KEY</code> or <code>MAX_KEY</code> (Atom)</p>

<p>This is how to encode a sample Elixir Keyword into a Bson Documentation:</p>

<pre><code class="elixir">bson = Bson.encode a: 1, b: &quot;2&quot;, c: [1,2,3], d: [d1: 10, d2: 11]
</code></pre>

<p>In this case, <code>bson</code> would be a document with 4 elements (an Integer, a String, an Array and an embeded document)</p>

<p>Conversly, to decode a bson document:
<code>elixir
[a: 1] == Bson.decode &lt;&lt;12, 0, 0, 0, 16, 97, 0, 1, 0, 0, 0, 0&gt;&gt;
</code></p>

<p>Special Bson element that do not have obvious corresponding type in Elixir are represented with Record, for example:</p>

<pre><code class="elixir">jsbson = Bson.encode js: Bson.JS.new code:&quot;function(a) return a+b;&quot;, scope: [b: 2]
rebson = Bson.encode re: Bson.Regex.new pattern: &quot;\d*&quot;, opts: &quot;g&quot;
</code></pre>

<p>Implementation of encoders and decoders is done using <code>Protocol</code>, so, it is possible to redefine them (for instance, encoding end decoding of Bson.Bin could be redefined for the userdefined subtype)</p>

    </div>
  </body>
</html>

